<?php
/**
 * Visualisation d'un ministre
 * 
 * @var Minister $modelInstance
 */
$ideas=$modelInstance->ideas()->getQuery()->orderBy('id')->get(['id', 'name']);
?>

<?php $__env->startSection('title'); ?><span class="text-primary"><?php echo $modelInstance->formatedId(); ?></span> <?php echo $modelInstance->name(); ?> <?php $__env->stopSection(); ?>
<?php $__env->startSection('content'); ?>
<div class="row">
	<div class="col-md-12">
		<div class="block-flat">
			<div class="header">
				<h3>Fonctions</h3>
			</div>
			<div class="content">
				<div class="table-responsive mandates">
					<table class="table table-hover datatable" data-ajaxurl="<?php echo route('ministersMandatesGetData', $modelInstance->id); ?>" data-bFilter="true" data-bSort="true" data-bPaginate="true" data-desc="true">
						<thead>
							<tr>
								<th>Début</th>
								<th>Fin</th>
								<th>Gouvernement</th>
								<th>Fonction</th>
								<th>Actions</th>
							</tr>
						</thead>
						<tbody>
						</tbody>
					</table>
				</div>
				<?php if($modelInstance->canManage()): ?>
				<div class="form-group">
					<a class="btn btn-sm btn-primary servermodal" href="<?php echo route('ministersMandatesGetCreate', [$modelInstance->id]); ?>" data-reload-datatable="div.mandates table.datatable"><i class="fa fa-plus"></i> Ajouter une fonction</a>
				</div>
				<?php endif; ?>
			</div>
		</div>
		<div class="block-flat">
			<div class="header">
				<h3>Projets liés</h3>
			</div>
			<div class="content">
				<?php if($ideas->isEmpty()): ?>
					<p>Ce ministre n'est lié à aucun projet de simplif'.</p>
				<?php else: ?>
				<ul class="list-group">
					<?php foreach($ideas as $idea): ?>
					<li class="list-group-item">
						<strong><?php echo DateHelper::year($idea->created_at) . '-' . str_pad ( $idea->id, 4, "0", STR_PAD_LEFT ); ?></strong>
						<a href="<?php echo route('ideasGetView', $idea->id); ?>"><?php echo $idea->name; ?></a>
					</li>
					<?php endforeach; ?>
				</ul>
				<?php endif; ?>
			</div>
		</div>
	</div>
</div>
<?php $__env->stopSection(); ?>
<?php echo $__env->make('site.layouts.container-fluid', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>